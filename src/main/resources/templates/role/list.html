<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>部门信息</title>
<link rel="stylesheet" th:href="@{/css/showButton.css}">

<link rel="stylesheet" th:href="@{/hplus/css/bootstrap.min.css?v=3.3.6}">
<link rel="stylesheet" th:href="@{/hplus/css/font-awesome.css?v=4.4.0}">
<link rel="stylesheet" th:href="@{/hplus/css/plugins/iCheck/custom.css}">
<link rel="stylesheet" th:href="@{/hplus/css/plugins/chosen/chosen.css}">
<link rel="stylesheet" th:href="@{/hplus/css/plugins/colorpicker/css/bootstrap-colorpicker.min.css}">
<link rel="stylesheet" th:href="@{/hplus/css/plugins/cropper/cropper.min.css}">
<link rel="stylesheet" th:href="@{/hplus/css/plugins/switchery/switchery.css}">
<link rel="stylesheet" th:href="@{/hplus/css/plugins/jasny/jasny-bootstrap.min.css}">
<link rel="stylesheet" th:href="@{/hplus/css/plugins/nouslider/jquery.nouislider.css}">
<link rel="stylesheet" th:href="@{/hplus/css/plugins/datapicker/datepicker3.css}">
<link rel="stylesheet" th:href="@{/hplus/css/plugins/ionRangeSlider/ion.rangeSlider.css}">
<link rel="stylesheet" th:href="@{/hplus/css/plugins/ionRangeSlider/ion.rangeSlider.skinFlat.css}">
<link rel="stylesheet" th:href="@{/hplus/css/plugins/awesome-bootstrap-checkbox/awesome-bootstrap-checkbox.css}">
<link rel="stylesheet" th:href="@{/hplus/css/plugins/clockpicker/clockpicker.css}">
<link rel="stylesheet" th:href="@{/hplus/css/animate.css}">
<link rel="stylesheet" th:href="@{/hplus/css/style.css?v=4.1.0}">
<!-- Sweet Alert -->
<link rel="stylesheet" th:href="@{/hplus/css/plugins/sweetalert/sweetalert.css}">
<!-- jqgrid -->
<link rel="stylesheet" th:href="@{/hplus/css/plugins/jqgrid/ui.jqgrid.css}">

<style type="text/css">
th{
	text-align: center;
}
</style>
</head>
<body class="gray-bg">
	<div class="viewport">
		<div class="button-row">
			<button type="button" class="btn btn-primary" id="B_BASE_INFO_ROLE_ADD"><i class="fa fa-plus"></i> 新增</button>
			<button type="button" class="btn btn-primary" id="B_BASE_INFO_ROLE_EDIT"><i class="fa fa-edit"></i> 编辑</button>
			<button type="button" class="btn btn-primary" id="B_BASE_INFO_ROLE_REMOVE"><i class="fa fa-remove"></i> 删除</button>
			<button type="button" class="btn btn-primary" id="B_BASE_INFO_ROLE_SEARCH"><i class="fa fa-search"></i> 检索</button>
		</div>
		<div class="show-area">
		<div class="row">
			<div class="col-sm-12">
				<div class="ibox float-e-margins" style="margin-bottom: 0px;">
					<div class="ibox-content">
						<div class="row">
							<div class="col-sm-12">
								<form class="form-inline" id="formlist">
									<div class="form-group col-sm-4 row-top">
										<label for="departmentCode">部门编号：</label>
										<input type="text" class="form-control" id="departmentCode" name="departmentCode" placeholder="请输入部门编号">
									</div>
									<div class="form-group col-sm-4 row-top">
										<label for="departmentName">部门名称：</label>
										<input type="text" class="form-control" id="departmentName" name="departmentName" placeholder="请输入部门名称">
									</div>
									<div class="form-group col-sm-4 row-top">
										<label for="exampleInputName2">部门状态：</label>
										<div class="input-group">
											<select id="validateFlag" name="validateFlag" data-placeholder="请选择部门状态" class="chosen-select" style="width:14.2em;" tabindex="2">
												<option value="">请选择部门状态</option>
												<option  th:each="m,obj:${validateFlag}" th:value="${m.key}" th:text="${m.value}"></option>
											</select>
										</div>
									</div>
								</form>
							</div>
						</div>
					</div>
				</div>
				<div class="ibox float-e-margins">
					<div class="ibox-content">
						<div class="row">
							<div class="col-sm-12">
								<div class="jqGrid_wrapper">
									<table id="table_list_1"></table>
									<div id="pager_list_1"></div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		</div>
	</div>
	<!-- 全局js -->
	<script type="text/javascript" th:src="@{/hplus/js/jquery.min.js?v=2.1.4}"></script>
	<script type="text/javascript" th:src="@{/hplus/js/bootstrap.min.js?v=3.3.6}"></script>
	<!-- 自定义js -->
	<script type="text/javascript" th:src="@{/hplus/js/content.js?v=1.0.0}"></script>
	<!-- Chosen -->
	<script type="text/javascript" th:src="@{/hplus/js/plugins/chosen/chosen.jquery.js}"></script>
	<!-- JSKnob -->
	<script type="text/javascript" th:src="@{/hplus/js/plugins/jsKnob/jquery.knob.js}"></script>
	<!-- Input Mask-->
	<script type="text/javascript" th:src="@{/hplus/js/plugins/jasny/jasny-bootstrap.min.js}"></script>
	<!-- Data picker -->
	<script type="text/javascript" th:src="@{/hplus/js/plugins/datapicker/bootstrap-datepicker.js}"></script>
	<!-- Prettyfile -->
	<script type="text/javascript" th:src="@{/hplus/js/plugins/prettyfile/bootstrap-prettyfile.js}"></script>
	<!-- Switchery -->
	<script type="text/javascript" th:src="@{/hplus/js/plugins/switchery/switchery.js}"></script>
	<!-- IonRangeSlider -->
	<script type="text/javascript" th:src="@{/hplus/js/plugins/ionRangeSlider/ion.rangeSlider.min.js}"></script>
	<!-- iCheck -->
	<script type="text/javascript" th:src="@{/hplus/js/plugins/iCheck/icheck.min.js}"></script>
	<!-- MENU -->
	<script type="text/javascript" th:src="@{/hplus/js/plugins/metisMenu/jquery.metisMenu.js}"></script>
	<!-- Color picker -->
	<script type="text/javascript" th:src="@{/hplus/js/plugins/colorpicker/bootstrap-colorpicker.min.js}"></script>
	<!-- Clock picker -->
	<script type="text/javascript" th:src="@{/hplus/js/plugins/clockpicker/clockpicker.js}"></script>
	<!-- Image cropper -->
	<script type="text/javascript" th:src="@{/hplus/js/plugins/cropper/cropper.min.js}"></script>
	<script type="text/javascript" th:src="@{/hplus/js/demo/form-advanced-demo.js}"></script>
	<!-- Sweet alert -->
	<script type="text/javascript" th:src="@{/hplus/js/plugins/sweetalert/sweetalert.min.js}"></script>
	<!-- 自定义 -->
	<script type="text/javascript" th:src="@{/js/bolue.js}"></script>
	<!-- jqGrid -->
	<script type="text/javascript" th:src="@{/hplus/js/plugins/jqgrid/i18n/grid.locale-cn.js}"></script>
	<script type="text/javascript" th:src="@{/hplus/js/plugins/jqgrid/jquery.jqGrid.min.js}"></script>
	
	<script type="text/javascript">
		$(function(){
			
			//删除
			$("#B_BASE_INFO_ROLE_REMOVE").click(function(){
				var rowId = $("#table_list_1").jqGrid("getGridParam", "selrow");
				if(isEmpty(rowId)){
					window.parent.showMsg("提示信息", "请选择要操作的数据");
					return;
				}
				var data = $("#table_list_1").jqGrid("getRowData", rowId);
				swal({
					title: "您确定要删除这条信息吗",
					text: "删除后将无法恢复，请谨慎操作！",
					type: "warning",
					showCancelButton: true,
					cancelButtonText: "取消",
					confirmButtonColor: "#DD6B55",
					confirmButtonText: "删除",
					closeOnConfirm: false
				}, function () {
					$.ajax({
						type: "post",
						url: "/baseinfo/role/remove",
						data: {"departmentCode": data.departmentCode},
						dataType: "json",
						success: function(data){
							console.log(data);
							if(data.success){
								var url = "/baseinfo/role/search";
								var data = $("#formlist").serialize();
								$("#table_list_1").jqGrid("setGridParam",{url: url, postData: data}).trigger("reloadGrid");
								swal("成功提示", data.errorMessage, "success");
							}else{
								swal("异常提示", data.errorMessage);
							}
						}
					});
				});
			});
			
			//编辑
			$("#B_BASE_INFO_ROLE_EDIT").click(function(){
				var rowId = $("#table_list_1").jqGrid("getGridParam", "selrow");
				if(isEmpty(rowId)){
					window.parent.showMsg("提示信息", "请选择要操作的数据");
					return;
				}
				var data = $("#table_list_1").jqGrid("getRowData", rowId);
				window.parent.commonModelByUrl("baseinfo/role/edit?departmentCode="+data.departmentCode);
			});
			
			//检索
			$("#B_BASE_INFO_ROLE_SEARCH").click(function(){
				var url = "/baseinfo/role/search";
				var data = $("#formlist").serialize();
				$("#table_list_1").jqGrid("setGridParam",{url: url, postData: data}).trigger("reloadGrid");
			});
			
			//新增
			$("#B_BASE_INFO_ROLE_ADD").click(function(){
				window.parent.commonModelByUrl("baseinfo/role/add");
			});
			
			//jqgrid自适应宽度
			$(window).bind('resize', function () {
				var width = $('.jqGrid_wrapper').width();
				$('#table_list_1').setGridWidth(width);
				$('#table_list_2').setGridWidth(width);
			});
			
			$.jgrid.defaults.styleUI = 'Bootstrap';
			$("#table_list_1").jqGrid({
				mtype: "post",//向后台请求数据的ajax的类型。可选post,get
				url: "/baseinfo/role/search",
				//postData: data,
				datatype: "json",
				width:"100%",
				height: 250,
				autowidth: true,
				shrinkToFit: true,
				rownumbers: true, //显示行顺序号
				rowNum: 14,
				rowList: [10, 20, 30],
				sortname: 'departmentCode',//初始化的时候排序的字段
				sortorder: "desc",//排序方式,可选desc,asc
				pagerpos: 'left',//翻页部分
				recordpos: 'center',//显示共多少条部分
				//cellsubmit:'remote',//or 'clientArray',remote代表每次编辑提交后进行服务器保存，clientArray只保存到数据表格不保存到服务器
				//multiselect: true,//开启复选框
				colNames: ['部门编号', '部门名称', '部门状态', '创建时间', '创建人', '更新时间', '更新人'],
				colModel: [
					{
						name: 'departmentCode',
						index: 'departmentCode',
						width: 100,
						sorttype: "folat"
					},
					{
						name: 'departmentName',
						index: 'departmentName',
						width: 100,
						sorttype: "folat"
					},
					{
						name: 'validateFlag',
						index: 'validateFlag',
						width: 60,
						align: "center",
						formatter: isValidFmatter
					},
					{
						name: 'createTime',
						index: 'createTime',
						width: 100,
						align: "center",
						sorttype: "date",
						formatter: "date",
						sortable: false
					},
					{
						name: 'createUser',
						index: 'createUser',
						width: 50,
						align: "center",
						sortable: false
					},
					{
						name: 'updateTime',
						index: 'updateTime',
						width: 100,
						align: "center",
						sorttype: "date",
						formatter: "date",
						sortable: false
					},
					{
						name: 'updateUser',
						index: 'updateUser',
						width: 50,
						align: "center",
						sortable: false
					}
				],
				pager: "#pager_list_1",
				viewrecords: true,
				//caption: "jqGrid 示例1",
				hidegrid: false
			});
		});
		
	</script>
</body>
</html>